<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Quiz System</title>

<style>
body{
  font-family: 'Segoe UI', Arial, sans-serif;
  background: linear-gradient(120deg,#e0e7ff,#f8fafc);
  padding:20px;
}

.container{
  max-width:900px;
  margin:auto;
  background:#ffffff;
  padding:25px;
  border-radius:14px;
  box-shadow:0 20px 40px rgba(0,0,0,0.08);
}

h1,h2{text-align:center;}

textarea,input{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:8px;
  border:1px solid #cbd5e1;
  font-size:15px;
}

button{
  width:100%;
  padding:12px;
  margin-top:12px;
  border:none;
  border-radius:10px;
  background:#2563eb;
  color:#fff;
  font-size:16px;
  cursor:pointer;
  transition:0.3s;
}

button:hover{background:#1e40af;}

.question{
  background:#f1f5f9;
  padding:18px;
  margin-top:18px;
  border-radius:12px;
}

.option-card{
  background:#ffffff;
  border:2px solid #e2e8f0;
  padding:12px 16px;
  margin:10px 0;
  border-radius:10px;
  cursor:pointer;
  transition:0.2s;
}

.option-card:hover{
  transform:scale(1.01);
  background:#f8fafc;
}

.option-card.selected{
  border-color:#2563eb;
  background:#e0e7ff;
}

.option-card.correct{
  background:#dcfce7;
  border-color:#22c55e;
  color:#14532d;
}

.option-card.wrong{
  background:#fee2e2;
  border-color:#ef4444;
  color:#7f1d1d;
}

.hidden{display:none;}

.result-box{
  background:#f8fafc;
  padding:20px;
  margin-top:20px;
  border-radius:12px;
  font-size:18px;
  text-align:center;
}
</style>
</head>

<body>
<div class="container">

<h1>üß† Quiz System</h1>

<div id="modeSelect">
  <button onclick="setMode('teacher')">üë®‚Äçüè´ –ú“±“ì–∞–ª—ñ–º</button>
  <button onclick="setMode('student')">üë®‚Äçüéì –°—Ç—É–¥–µ–Ω—Ç</button>
</div>

<!-- TEACHER -->
<div id="teacher" class="hidden">
  <h2>–¢–µ—Å—Ç “õ“±—Ä–∞—Å—Ç—ã—Ä—É</h2>
  <textarea id="inputQuestions" rows="8"
  placeholder="–í–æ–ø—Ä–æ—Å | *–¥“±—Ä—ã—Å –∂–∞—É–∞–ø | –≤–∞—Ä–∏–∞–Ω—Ç2 | –≤–∞—Ä–∏–∞–Ω—Ç3 | –≤–∞—Ä–∏–∞–Ω—Ç4"></textarea>
  <button onclick="createSession()">–°–µ—Å—Å–∏—è –∞—à—É</button>
  <p id="sessionInfo" style="text-align:center;font-weight:bold;"></p>
</div>

<!-- STUDENT -->
<div id="student" class="hidden">
  <h2>–¢–µ—Å—Ç–∫–µ –∫—ñ—Ä—É</h2>
  <input id="sessionCodeInput" placeholder="–°–µ—Å—Å–∏—è –∫–æ–¥—ã–Ω –µ–Ω–≥—ñ–∑">
  <input id="studentName" placeholder="–ê—Ç—ã“£">
  <button onclick="loadSession()">–ë–∞—Å—Ç–∞—É</button>

  <div id="quiz"></div>

  <button onclick="finishTest()">–ê—è“õ—Ç–∞—É</button>
  <div id="result"></div>
</div>

</div>

<script>
let quizData=[];
let startTime;
let sessionCode='';

function setMode(m){
  document.getElementById('modeSelect').classList.add('hidden');
  document.getElementById(m).classList.remove('hidden');
}

function createSession(){
  const lines=document.getElementById('inputQuestions').value.trim().split('\n');
  quizData=[];
  lines.forEach(line=>{
    const parts=line.split('|').map(p=>p.trim());
    const correct=parts.find(p=>p.startsWith('*')).replace('*','');
    const options=parts.slice(1).map(p=>p.replace('*',''));
    quizData.push({q:parts[0],options,correct});
  });

  sessionCode=Math.random().toString(36).substring(2,7).toUpperCase();
  localStorage.setItem(sessionCode,JSON.stringify({quizData,results:[]}));
  document.getElementById('sessionInfo').innerText=`–°–µ—Å—Å–∏—è –∫–æ–¥—ã: ${sessionCode}`;
}

function shuffle(arr){
  return arr.sort(()=>Math.random()-0.5);
}

function loadSession(){
  sessionCode=document.getElementById('sessionCodeInput').value;
  const data=JSON.parse(localStorage.getItem(sessionCode));
  if(!data){alert('–°–µ—Å—Å–∏—è —Ç–∞–±—ã–ª–º–∞–¥—ã');return;}

  quizData=shuffle([...data.quizData]);
  startTime=Date.now();

  const quiz=document.getElementById('quiz');
  quiz.innerHTML='';

  quizData.forEach((q,i)=>{
    q.selected=null;
    const div=document.createElement('div');
    div.className='question';
    div.innerHTML=`<b>${i+1}. ${q.q}</b>`;

    let opts=shuffle([...q.options]);
    opts.forEach(o=>{
      const card=document.createElement('div');
      card.className='option-card';
      card.innerText=o;

      card.onclick=()=>{
        if(q.selected!==null) return;
        q.selected=o;

        const cards=div.querySelectorAll('.option-card');
        cards.forEach(c=>c.classList.remove('selected'));

        card.classList.add('selected');
      };

      div.appendChild(card);
    });

    quiz.appendChild(div);
  });
}

function finishTest(){
  let score=0;

  quizData.forEach((q,i)=>{
    const cards=document.querySelectorAll(`.question:nth-child(${i+1}) .option-card`);
    cards.forEach(c=>{
      if(c.innerText===q.correct) c.classList.add('correct');
      if(q.selected!==q.correct && c.innerText===q.selected) c.classList.add('wrong');
    });

    if(q.selected===q.correct) score++;
  });

  const time=Math.floor((Date.now()-startTime)/1000);
  const percent=Math.round((score/quizData.length)*100);

  document.getElementById('result').innerHTML=
    `<div class="result-box">
      ‚úÖ –î“±—Ä—ã—Å –∂–∞—É–∞–ø: <b>${score}</b> / ${quizData.length}<br>
      üìä –ü–∞–π—ã–∑: <b>${percent}%</b><br>
      ‚è± –£–∞“õ—ã—Ç: <b>${time} —Å–µ–∫</b>
    </div>`;
}
</script>

</body>
</html>
